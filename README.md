# System Design социальной сети для путешественников
для [курса по System Design](https://balun.courses/courses/system_design)

-![tavel](images/travel.png)

## Функциональные требования
- публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия;
- оценка и комментарии постов других путешественников;
- подписка на других путешественников, чтобы следить за их активностью;
- поиск популярных мест для путешествий и просмотр постов с этих мест;
- просмотр ленты других путешественников и ленты пользователя, основанной на подписках в обратном хронологическом порядке;

## Не Функциональные требования
- DAU 10 000 000
- Активности пользователей

    - Публикация поста - в среднем 1 в сутки
    - Чтение ленты - в среднем 20 постов в сутки
    - Комментирование поста - в среднем 5 в сутки
    - Чтение комментариев - в среднем 30 в сутки
    - Отправка реакции на пост - в среднем 15 в сутки
- Регион - Только на СНГ
- Сезонность влияет на нагрузку. В сезон отпусков наплыв пользователей увеличивается. Увиличивает поток на чтение и на добавление постов.
- Данные храним всегда
- Лимита по подписчикам нет
- Временные ограничения

    - Добавление поста - 2 секунды
    - Пост может попадать в ленту подпищиков с задержкой (до 3-х минут)
    - Выставление реакций - мгновенно (~300мс)
    - Добавление коментария - мгновенно (~300мс)
- Не более, чем 1 час простоя в год. (SLA 99,99)

## Сущности

### Post
- post_id - 8 Б
- user_id - 8 Б
- place_id - 8 Б
- content - 500 Б
- photos - ~ 4МБ => 4000000 Б

### Comment
- post_id - 8 Б
- user_id - 8 Б
- message - 200 Б

### Reaction
- post_id - 8 Б
- user_id - 8 Б
- reaction_id - 8 Б

## Расчет нагрузки

### RPS
- Post (`write`) 10 000 000 / 86400 = 116 RPS
- Post (`read`) (10 000 000 * 20) / 86400 = 2315 RPS

- Coment (`write`) (10 000 000 * 5) / 86400 = 579 RPS
- Coment (`read`) (10 000 000 * 30) / 86400 = 3472 RPS

- Reaction (`write`) (10 000 000 * 15) / 86400 = 1736 RPS
- Reaction (`read`) (10 000 000 * 20) / 86400 = 2315 RPS

### Трафик
- Post (`write`) 116 RPS * 4000600 Б = 464069,6 КБ/с = 464 МБ/с
- Post (`read`) 2315 RPS * 4000600 Б = 9261389 КБ/с = 9261 МБ/с = 9.2 ГБ/с

- Coment (`write`) 579 RPS * 216 Б = 125 КБ/с
- Coment (`read`) 3472 RPS * 216 Б = 750 КБ/с

- Reaction (`write`) 1736 RPS * 32 Б = 56 КБ/с
- Reaction (`read`) 2315 RPS * 32 Б = 74 КБ/с


### Соединения
- Соединения 10 000 000 * 0.1 = 1 000 000